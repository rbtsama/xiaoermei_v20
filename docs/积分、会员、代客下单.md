# 酒店管理系统积分、会员、代客下单功能PRD

## 一、核心交互流程梳理

### **流程1：用户注册 → 获得积分**

```
【C端】用户注册
   ↓
填写手机号、密码
   ↓
【平台后台】自动触发
   ↓ 
创建用户账户 
→ 初始化VIP0等级（间夜数=0）
→ 自动发放30积分
→ 记录注册时间
   ↓
【C端】注册成功页
   ↓
显示：欢迎XXX，已获得30积分，当前VIP0等级
```

------

### **流程2：会员等级升降机制**

#### **2.1 升级流程**

```
【平台后台】设定升级规则
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
VIP0 → VIP1：累计5间夜，有效期365天
VIP1 → VIP2：累计15间夜，有效期365天
VIP2 → VIP3：累计30间夜，有效期365天
VIP3 → VIP4：累计60间夜，有效期365天
...
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
【订单维度】用户完成订单 → 订单状态变更为"已离店"
   ↓
【平台后台】自动计算间夜数
   ↓
间夜数 = 离店日期 - 入住日期
累计间夜数 = 原累计 + 本次间夜
   ↓
检查升级条件：累计间夜是否达标？
   ↓
达标 → 升级会员等级 
     → 设置会员有效期（如365天后到期）
     → 重置保级间夜计数器=0
   ↓
【C端】收到升级通知
   ↓
"恭喜升级至VIP3！享受88折优惠，积分价值提升至1.2倍
有效期至2026年11月22日，期间完成20间夜可保级"
```

#### **2.2 保级/掉级流程**

```
【平台后台】设定保级规则
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
VIP1保级：有效期内完成3间夜
VIP2保级：有效期内完成8间夜
VIP3保级：有效期内完成15间夜
VIP4保级：有效期内完成25间夜
...
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
【平台后台】定时任务（每日凌晨）
   ↓
扫描所有用户会员有效期
   ↓
发现用户A的VIP3会员今日到期
   ↓
检查有效期内的保级间夜数：12间夜（需要15间夜）
   ↓
未达标 → 降级至VIP2
        → 重新设置有效期（VIP2的有效期规则）
        → 重置保级间夜计数器=0
   ↓
【C端】收到通知
   ↓
"您的VIP3会员已到期，因有效期内未完成15间夜，已降级至VIP2
继续努力，完成8间夜即可保持VIP2等级"
```

**关键数据记录：**

- 用户表字段：
  - 当前会员等级
  - 累计总间夜数（用于升级）
  - 当前等级有效期
  - 保级间夜计数器（有效期内的间夜数）

------

### **流程3：邀请好友 → 获得奖励积分**

```
【C端】用户A点击"邀请好友"
   ↓
【小程序】调用微信分享接口
   ↓
选择微信好友 → 发送小程序卡片
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
[小程序卡片]
好友XXX邀请你入住优惠酒店
新人注册立享30积分
[立即注册]
━━━━━━━━━━━━━━━━━━━━━━━━
卡片链接自动携带：inviter_id=用户A的ID
   ↓
【C端】用户B点击卡片 → 打开小程序注册页
   ↓
注册表单自动填充邀请码（用户不可见，后台处理）
   ↓
【平台后台】记录邀请关系：B的推荐人=A
   ↓
【订单维度】用户B完成首次预订 → 入住 → 离店
   ↓
【平台后台】监听订单状态变更为"已离店"
   ↓
检查：
1. 该订单用户是否有推荐人？☑ 是（推荐人=A）
2. 是否首单？☑ 是（订单表中B的历史订单数=1）
   ↓
自动给用户A发放30积分
   ↓
【C端】用户A收到通知
   ↓
"您的好友张三完成首次入住，获得30积分奖励！"
```

------

### **流程4：浏览酒店 → 查看会员专属价格**

```
【C端】用户打开小程序
   ↓
【平台后台】读取用户信息
   ↓
用户ID、会员等级（如VIP3）、积分余额
   ↓
【C端】用户浏览酒店列表
   ↓
【平台后台】价格计算逻辑（针对每个酒店）
   ↓
步骤1：判断当日是否可用VIP折扣
━━━━━━━━━━━━━━━━━━━━━━━━
读取商户端设置：
• 平日：允许VIP折扣
• 周末：允许VIP折扣
• 节假日：不允许VIP折扣

当前日期：2025-11-28（节假日）
结论：不可用VIP折扣
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
不可用VIP折扣 → 显示原价
可用VIP折扣 → 继续步骤2
   ↓
步骤2：计算VIP折扣价格
━━━━━━━━━━━━━━━━━━━━━━━━
用户等级：VIP3

【平台后台】读取平台折扣范围限制
VIP3平台折扣范围：85折-9折

【商户端】读取本店VIP3折扣设置
本店VIP3折扣：88折（在平台范围内，有效）

【商户端】读取时段额外折扣
当日为平日 → 平日额外折扣：再打9折

最终折扣计算：
房型原价：¥500
VIP3折扣：¥500 × 0.88 = ¥440
平日额外：¥440 × 0.9 = ¥396
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
【C端】酒店列表页展示
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
[酒店A]
XX豪华酒店
[酒店图片]
¥396起/晚  VIP3专享
原价¥500  平日特惠
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
用户点击进入酒店详情页
   ↓
【C端】酒店详情页展示
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
XX豪华酒店  VIP3专享价

[房型1] 豪华大床房
原价：¥500
VIP3折扣：¥440（88折）
平日特惠：¥396（再9折）
[选择]

[房型2] 豪华双床房
原价：¥600
VIP3折扣：¥528（88折）
平日特惠：¥475（再9折）
[选择]

[房型3] 行政套房
原价：¥800
VIP3折扣：¥704（88折）
平日特惠：¥634（再9折）
[选择]
━━━━━━━━━━━━━━━━━━━━━━━━
```

**价格计算优先级：**

1. 判断当日是否可用VIP折扣（商户端设置）
2. 应用VIP等级折扣（商户端设置，受平台范围限制）
3. 应用时段额外折扣（商户端设置）

------

### **流程5：下单 → 积分抵扣/服务 → 支付**

```
【C端】用户选择房型 → 点击"预订"
   ↓
选择入住/离店日期 → 进入订单确认页
   ↓
【平台后台】读取用户剩余积分：80积分
   ↓
【商户端】读取积分服务配置
   ↓
【C端】订单确认页展示
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
XX豪华酒店 - 豪华大床房
入住：2025-11-28
离店：2025-11-29

房费：¥396（VIP3平日特惠价）

【积分服务】
环保奖励（离店后返还）
☐ 自带拖鞋 -5积分
☐ 自带牙刷 -3积分
☐ 自带毛巾 -5积分

增值服务（立即扣除）
□ 单人早餐 +20积分
□ 双人早餐 +35积分
□ 延迟退房（2小时）+15积分

【积分抵扣】
当前积分：80
积分价值：1.2倍（VIP3汇率）
输入框：[__] 积分（最多可用66积分）

━━━━━━━━━━━━━━━━━━━━━━━━
应付金额：¥396
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
用户操作：
1. 勾选"自带拖鞋"（承诺离店后获得5积分）
2. 勾选"单人早餐"（需消耗20积分）
3. 输入"50"积分抵扣
   ↓
【平台后台】实时校验
   ↓
校验逻辑：
• 服务消耗积分：20
• 抵扣消费积分：50
• 总需积分：70
• 当前积分：80
• 结论：☑ 通过（70 ≤ 80）

价格计算：
• 房费：¥396
• 积分抵扣：50 × 1.2 = ¥60
• 应付：¥396 - ¥60 = ¥336
   ↓
【C端】动态显示应付金额
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
积分使用明细：
• 兑换单人早餐：-20积分
• 抵扣房费：-50积分（¥60）
• 自带拖鞋承诺：离店后+5积分

应付金额：¥336
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
用户点击"确认支付"
   ↓
【平台后台】预扣除积分
   ↓
• 剩余积分：80 - 20 - 50 = 10积分
• 创建订单
• 订单状态="待入住"
• 记录环保承诺：自带拖鞋（待发放5积分）
   ↓
【C端】支付¥336 → 支付成功页
```

**积分使用限制规则：**

- 最大可用积分 = min(剩余积分, 房费/积分汇率)
- 实时校验：服务消耗+抵扣消费 ≤ 剩余积分

------

### **流程6：离店 → 积分奖励 → 邀请奖励**

```
【商户端】用户退房
   ↓
订单状态改为"已离店"
   ↓
【平台后台】监听订单状态变更
   ↓
触发自动结算流程
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
步骤1：计算间夜数
• 入住日期：2025-11-28
• 离店日期：2025-11-29
• 间夜数：1

步骤2：更新用户间夜统计
• 累计总间夜数：29 → 30
• 保级间夜计数器：14 → 15

步骤3：检查升级条件
• 当前等级：VIP2
• 升级条件：累计30间夜
• 结论：☑ 达成升级条件
• 操作：升级至VIP3
        设置有效期：2026-11-28
        重置保级计数器=0

步骤4：发放环保奖励积分
• 检查环保承诺：自带拖鞋
• 发放：+5积分

步骤5：检查邀请奖励
• 该用户是否被推荐：☑ 是（推荐人=用户A）
• 是否首单：☑ 是
• 发放：给推荐人A +30积分
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
【C端】用户收到通知
   ↓
"感谢入住！
• 环保奖励：+5积分
• 恭喜升级至VIP3！有效期至2026年11月28日"
   ↓
【C端】推荐人A收到通知
   ↓
"您的好友张三完成首次入住，获得30积分奖励！"
```

------

### **流程7：代客下单 → 扫码支付（不支持积分）**

```
【商户端】选择"代客下单"功能
   ↓
填写订单信息：
━━━━━━━━━━━━━━━━━━━━━━━━
• 房型：豪华大床房
• 入住日期：2025-12-01
• 离店日期：2025-12-02
• 特殊价格：¥350
• 特殊要求：含双份早餐、延迟退房至14:00
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
点击"生成付款码"
   ↓
【平台后台】创建待支付订单
   ↓
• 订单号：DKD2025120101234
• 订单来源：代客下单
• 订单状态：待支付
• 支付次数限制：1次
• 有效期：7天
• 禁用积分功能标识：true
   ↓
生成付款二维码（小程序码）
   ↓
【商户端】显示付款信息页
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
[二维码图片]

XX豪华酒店
地址：北京市朝阳区XX路88号

豪华大床房
12月1日-12月2日（1晚）
含双份早餐、延迟退房至14:00

专属特惠价：¥350

请客户扫码完成支付
（此码仅可支付一次，7天内有效）

订单号：DKD2025120101234
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
商户截图/展示二维码给客户
   ↓
【C端】客户扫码 → 打开小程序
   ↓
【平台后台】校验
   ↓
• 订单是否存在？
• 订单是否过期？
• 订单是否已支付？
   ↓
校验通过 → 检查登录态
   ↓
未登录 → 引导登录/注册
已登录 → 继续
   ↓
【C端】展示订单详情页（不含积分功能）
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
XX豪华酒店
地址：北京市朝阳区XX路88号
电话：010-12345678

专属订单详情
━━━━━━━━━━━━━━━━━━━━━━━━
房型：豪华大床房
入住：2025年12月1日 14:00后
离店：2025年12月2日 14:00前

特殊服务：
• 含双份早餐
• 延迟退房至14:00

专属特惠价：¥350

━━━━━━━━━━━━━━━━━━━━━━━━
[确认支付]
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
客户点击"确认支付"
   ↓
【平台后台】再次校验
   ↓
• 订单未被支付？☑ 是
• 用户登录态有效？☑ 是
   ↓
发起支付流程
   ↓
【C端】调用微信支付
   ↓
支付成功
   ↓
【平台后台】处理
   ↓
• 订单关联用户ID
• 订单状态="待入住"
• 支付状态="已支付"
• 锁定订单（二维码失效）
   ↓
【C端】支付成功页
   ↓
━━━━━━━━━━━━━━━━━━━━━━━━
支付成功！

XX豪华酒店
入住日期：12月1日 14:00后
订单号：DKD2025120101234

[查看订单详情] [返回订单列表]
━━━━━━━━━━━━━━━━━━━━━━━━
   ↓
【商户端】收到订单通知
   ↓
"代客下单订单已支付
客户：张三（138****1234）
房型：豪华大床房
入住：12月1日"
```

**代客下单特殊规则：**

- 不支持积分抵扣和积分服务
- 二维码仅可支付一次
- 支付必须登录，绑定用户身份
- 订单有效期7天，超期自动作废
- 支付成功后可返回订单列表查看

------

## 二、三端功能PRD

### **【平台后台】功能PRD**

------

#### **模块1：积分规则配置**

**功能1.1：基础积分规则设置**

**功能描述：**
 平台管理员配置积分获取和使用的基础规则，包括注册奖励、邀请奖励、基础兑换汇率。

**页面路径：**
 平台后台 > 积分管理 > 基础规则配置

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
积分基础规则配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【积分获取规则】
┌─────────────────────────────────┐
│ 注册奖励积分                             │
│ [____30____] 积分                      │
│ 说明：新用户注册成功后自动发放             │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ 邀请奖励积分                             │
│ [____30____] 积分                      │
│ 说明：被邀请用户完成首次离店后发放给邀请人   │
└─────────────────────────────────┘

【积分使用规则】
┌─────────────────────────────────┐
│ 基础兑换汇率                             │
│ 1积分 = [____1____] 元                 │
│ 说明：用户使用积分抵扣现金的基础汇率        │
└─────────────────────────────────┘

[保存设置]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**字段说明：**

| 字段名称     | 字段类型 | 必填 | 默认值 | 说明           |
| ------------ | -------- | ---- | ------ | -------------- |
| 注册奖励积分 | 整数     | 是   | 30     | 范围：0-100    |
| 邀请奖励积分 | 整数     | 是   | 30     | 范围：0-100    |
| 基础兑换汇率 | 小数     | 是   | 1.0    | 范围：0.1-10.0 |

**操作逻辑：**

1. 修改配置后点击"保存设置"
2. 系统校验数值范围是否合法
3. 保存成功后，新规则立即生效（仅对新订单生效）
4. 记录操作日志（操作人、操作时间、修改内容）

------

**功能1.2：会员等级积分汇率配置**

**功能描述：**
 配置不同会员等级的积分使用汇率，等级越高，积分价值越大。

**页面路径：**
 平台后台 > 积分管理 > 会员等级汇率

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
会员等级积分汇率配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

说明：积分汇率决定会员使用积分抵扣现金的实际价值
例如：VIP3汇率为1.2倍，使用50积分可抵扣60元

┌─────────────────────────────────┐
│ 会员等级    | 积分汇率倍数 | 操作      │
│ ────────────────────────────── │
│ VIP0       | 1.0倍       | [编辑]    │
│ VIP1       | 1.05倍      | [编辑]    │
│ VIP2       | 1.1倍       | [编辑]    │
│ VIP3       | 1.2倍       | [编辑]    │
│ VIP4       | 1.3倍       | [编辑]    │
│ VIP5       | 1.4倍       | [编辑]    │
│ VIP6       | 1.5倍       | [编辑]    │
│ VIP7       | 1.6倍       | [编辑]    │
│ VIP8       | 1.8倍       | [编辑]    │
│ VIP9       | 2.0倍       | [编辑]    │
└─────────────────────────────────┘

[批量保存]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**编辑弹窗：**

```
┌─────────────────────────────────┐
│  编辑VIP3积分汇率                    │
│  ─────────────────────────────  │
│  当前汇率倍数：                       │
│  [____1.2____] 倍                  │
│                                    │
│  说明：会员使用积分抵扣现金的价值倍数     │
│  范围：1.0-3.0                      │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**字段说明：**

| 字段名称     | 字段类型 | 必填 | 取值范围 | 说明        |
| ------------ | -------- | ---- | -------- | ----------- |
| 积分汇率倍数 | 小数     | 是   | 1.0-3.0  | 保留1位小数 |

**操作逻辑：**

1. 点击"编辑"打开弹窗
2. 输入新的汇率倍数
3. 系统校验：必须≥前一等级的汇率（保证等级递增）
4. 保存成功后立即生效

------

#### **模块2：会员等级体系配置**

**功能2.1：会员等级升级规则配置**

**功能描述：**
 配置VIP0-VIP9的升级条件（累计间夜数）、有效期、保级条件。

**页面路径：**
 平台后台 > 会员管理 > 等级规则配置

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
会员等级升级与保级规则配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

┌────────────────────────────────────────────┐
│ 等级  | 升级条件    | 会员有效期 | 保级条件    | 操作  │
│ ──────────────────────────────────────── │
│ VIP0  | -          | -         | -          | -    │
│ VIP1  | 5间夜      | 365天     | 3间夜       | [编辑]│
│ VIP2  | 15间夜     | 365天     | 8间夜       | [编辑]│
│ VIP3  | 30间夜     | 365天     | 15间夜      | [编辑]│
│ VIP4  | 60间夜     | 365天     | 25间夜      | [编辑]│
│ VIP5  | 100间夜    | 365天     | 40间夜      | [编辑]│
│ VIP6  | 150间夜    | 365天     | 60间夜      | [编辑]│
│ VIP7  | 220间夜    | 365天     | 85间夜      | [编辑]│
│ VIP8  | 300间夜    | 365天     | 120间夜     | [编辑]│
│ VIP9  | 400间夜    | 365天     | 160间夜     | [编辑]│
└────────────────────────────────────────────┘

[批量保存]

说明：
• 升级条件：用户累计总间夜数达到此标准即可升级
• 有效期：升级后会员等级的有效期（从升级日起计算）
• 保级条件：有效期内需完成的间夜数，否则降级
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**编辑弹窗：**

```
┌─────────────────────────────────┐
│  编辑VIP3等级规则                    │
│  ─────────────────────────────  │
│  升级条件（累计间夜数）：              │
│  [____30____] 间夜                │
│                                    │
│  会员有效期：                        │
│  [____365____] 天                 │
│                                    │
│  保级条件（有效期内间夜数）：           │
│  [____15____] 间夜                │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**字段说明：**

| 字段名称   | 字段类型 | 必填 | 取值范围 | 说明           |
| ---------- | -------- | ---- | -------- | -------------- |
| 升级条件   | 整数     | 是   | 1-999    | 累计总间夜数   |
| 会员有效期 | 整数     | 是   | 30-730   | 单位：天       |
| 保级条件   | 整数     | 是   | 1-999    | 有效期内间夜数 |

**校验规则：**

1. 升级条件必须递增（VIP3 > VIP2 > VIP1）
2. 保级条件 ≤ 升级条件
3. 有效期建议为365天（可调整）

------

**功能2.2：会员等级折扣配置**

**功能描述：**
 配置各会员等级的平台基础折扣，以及商户可设置的折扣范围。

**页面路径：**
 平台后台 > 会员管理 > 折扣规则配置

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
会员等级折扣规则配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

说明：平台设定基础折扣，商户可在允许范围内设置更优惠的折扣

┌────────────────────────────────────────────┐
│ 等级  | 平台基础折扣 | 商户折扣范围      | 操作   │
│ ──────────────────────────────────────── │
│ VIP0  | 无折扣      | -                | -     │
│ VIP1  | 95折       | 90折-95折         | [编辑] │
│ VIP2  | 93折       | 85折-93折         | [编辑] │
│ VIP3  | 9折        | 85折-9折          | [编辑] │
│ VIP4  | 88折       | 80折-88折         | [编辑] │
│ VIP5  | 85折       | 75折-85折         | [编辑] │
│ VIP6  | 82折       | 70折-82折         | [编辑] │
│ VIP7  | 8折        | 65折-8折          | [编辑] │
│ VIP8  | 75折       | 60折-75折         | [编辑] │
│ VIP9  | 7折        | 55折-7折          | [编辑] │
└────────────────────────────────────────────┘

[批量保存]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**编辑弹窗：**

```
┌─────────────────────────────────┐
│  编辑VIP3折扣规则                    │
│  ─────────────────────────────  │
│  平台基础折扣：                       │
│  [____9____] 折（例如：9折=0.9）   │
│                                    │
│  商户折扣范围：                       │
│  最低：[____85____] 折            │
│  最高：[____9____] 折             │
│                                    │
│  说明：商户设置的折扣必须在此范围内      │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**字段说明：**

| 字段名称     | 字段类型 | 必填 | 取值范围 | 说明             |
| ------------ | -------- | ---- | -------- | ---------------- |
| 平台基础折扣 | 小数     | 是   | 0.5-1.0  | 例如9折=0.9      |
| 商户折扣最低 | 小数     | 是   | 0.5-1.0  | 不能低于此折扣   |
| 商户折扣最高 | 小数     | 是   | 0.5-1.0  | 等于平台基础折扣 |

**校验规则：**

1. 平台基础折扣必须递减（VIP9 < VIP8 < ... < VIP1）
2. 商户折扣最高 = 平台基础折扣
3. 商户折扣最低 ≤ 商户折扣最高

------

**功能2.3：用户会员等级管理**

**功能描述：**
 查询、手动调整特定用户的会员等级和积分余额。

**页面路径：**
 平台后台 > 会员管理 > 用户等级管理

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
用户会员等级管理
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【搜索筛选】
┌─────────────────────────────────────────┐
│ 手机号：[___________]  会员等级：[全部 ▼]  │
│ [搜索]  [重置]                              │
└─────────────────────────────────────────┘

【用户列表】
┌──────────────────────────────────────────────────┐
│ 手机号       | 姓名  | 会员等级 | 累计间夜 | 积分 | 操作 │
│ ──────────────────────────────────────────────│
│ 138****1234 | 张三  | VIP3   | 32      | 150 | [详情]│
│ 139****5678 | 李四  | VIP2   | 18      | 80  | [详情]│
│ 136****9012 | 王五  | VIP1   | 7       | 200 | [详情]│
└──────────────────────────────────────────────────┘

[上一页] 1/10 [下一页]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**点击"详情"打开用户详情页：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
用户详情 - 张三
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【基本信息】
手机号：138****1234
姓名：张三
注册时间：2024-05-20

【会员信息】
当前等级：VIP3
升级时间：2025-10-15
有效期至：2026-10-15
累计总间夜：32间夜
保级进度：12/15间夜（有效期内）

[手动调整等级]

【积分信息】
当前积分：150
积分汇率：1.2倍（VIP3专享）

[手动调整积分]

【间夜记录】
┌─────────────────────────────────┐
│ 订单号    | 酒店    | 入住日期  | 间夜数 │
│ ─────────────────────────────│
│ 20251101  | XX酒店  | 2025-11-01| 2    │
│ 20251015  | YY酒店  | 2025-10-15| 1    │
│ ...                                │
└─────────────────────────────────┘

【积分明细】
┌─────────────────────────────────┐
│ 时间      | 类型        | 金额  | 余额  │
│ ─────────────────────────────│
│ 2025-11-10| 环保奖励    | +5   | 150  │
│ 2025-11-10| 抵扣房费    | -50  | 145  │
│ 2025-11-10| 兑换早餐    | -20  | 195  │
│ ...                                │
└─────────────────────────────────┘

[返回列表]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**手动调整等级弹窗：**

```
┌─────────────────────────────────┐
│  手动调整会员等级                    │
│  ─────────────────────────────  │
│  当前等级：VIP3                     │
│                                    │
│  调整为：[VIP4 ▼]                  │
│                                    │
│  有效期：[____365____] 天          │
│                                    │
│  调整原因：                         │
│  [________________________]       │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**手动调整积分弹窗：**

```
┌─────────────────────────────────┐
│  手动调整积分                        │
│  ─────────────────────────────  │
│  当前积分：150                      │
│                                    │
│  调整类型：[增加 ▼] [减少 ▼]       │
│  调整数量：[________] 积分         │
│                                    │
│  调整原因：                         │
│  [________________________]       │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**操作逻辑：**

1. 所有手动调整操作需记录操作日志
2. 调整原因为必填项
3. 调整等级不影响累计间夜数
4. 调整积分立即生效

------

#### **模块3：数据统计与监控**

**功能3.1：积分发放统计**

**页面路径：**
 平台后台 > 积分管理 > 数据统计

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
积分发放与使用统计
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【时间筛选】
[最近7天 ▼] [2025-11-16] 至 [2025-11-22]

【核心数据】
┌─────────────────────────────────┐
│ 累计发放积分：123,456            │
│ 累计使用积分：98,765             │
│ 当前流通积分：24,691             │
└─────────────────────────────────┘

【积分发放明细】
┌─────────────────────────────────┐
│ 发放类型      | 数量    | 占比      │
│ ─────────────────────────────│
│ 注册奖励      | 45,000 | 36.5%    │
│ 邀请奖励      | 32,100 | 26.0%    │
│ 环保奖励      | 46,356 | 37.5%    │
└─────────────────────────────────┘

【积分使用明细】
┌─────────────────────────────────┐
│ 使用类型      | 数量    | 占比      │
│ ─────────────────────────────│
│ 抵扣房费      | 78,234 | 79.2%    │
│ 兑换早餐      | 15,231 | 15.4%    │
│ 兑换服务      | 5,300  | 5.4%     │
└─────────────────────────────────┘

[导出报表]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

### **【商户端】功能PRD**

------

#### **模块1：积分服务配置**

**功能1.1：积分服务管理**

**功能描述：**
 商户自主配置环保奖励项目和增值服务项目，设定对应的积分数量。

**页面路径：**
 商户后台 > 积分服务 > 服务配置

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
积分服务配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【环保奖励服务】（用户选择后，离店后发放积分）
┌────────────────────────────────────────────┐
│ 服务名称      | 奖励积分 | 状态  | 操作          │
│ ──────────────────────────────────────── │
│ 自带拖鞋      | -5      | 启用  | [编辑] [停用]  │
│ 自带牙刷      | -3      | 启用  | [编辑] [停用]  │
│ 自带毛巾      | -5      | 停用  | [编辑] [启用]  │
└────────────────────────────────────────────┘
[+ 新增环保奖励]

【增值服务】（用户选择后，下单时扣除积分）
┌────────────────────────────────────────────┐
│ 服务名称          | 消耗积分 | 状态 | 操作        │
│ ──────────────────────────────────────── │
│ 单人早餐          | +20     | 启用 | [编辑] [停用]│
│ 双人早餐          | +35     | 启用 | [编辑] [停用]│
│ 延迟退房（2小时）  | +15     | 启用 | [编辑] [停用]│
│ 洗衣服务          | +10     | 停用 | [编辑] [启用]│
└────────────────────────────────────────────┘
[+ 新增增值服务]

说明：
• 环保奖励：用户承诺后离店时自动发放积分（信任用户，无需验证）
• 增值服务：用户选择后立即预扣除积分
• 停用的服务不会在用户下单页展示
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**新增/编辑服务弹窗：**

```
┌─────────────────────────────────┐
│  新增环保奖励服务                    │
│  ─────────────────────────────  │
│  服务名称：                         │
│  [___自带拖鞋___]                  │
│                                    │
│  奖励积分：                         │
│  [____5____] 积分                 │
│  （输入正数，用户离店后获得）          │
│                                    │
│  服务说明：                         │
│  [支持环保，自带拖鞋可获得积分奖励]   │
│                                    │
│  状态：☑ 启用                      │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
┌─────────────────────────────────┐
│  新增增值服务                        │
│  ─────────────────────────────  │
│  服务名称：                         │
│  [___单人早餐___]                  │
│                                    │
│  消耗积分：                         │
│  [____20____] 积分                │
│  （输入正数，用户下单时扣除）          │
│                                    │
│  服务说明：                         │
│  [含单人自助早餐，早餐时间7:00-10:00]│
│                                    │
│  状态：☑ 启用                      │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**字段说明：**

| 字段名称 | 字段类型 | 必填 | 取值范围  | 说明               |
| -------- | -------- | ---- | --------- | ------------------ |
| 服务名称 | 文本     | 是   | 2-20字符  | 服务的展示名称     |
| 积分数量 | 整数     | 是   | 1-999     | 环保奖励用负数表示 |
| 服务说明 | 文本     | 否   | 0-100字符 | 服务详细说明       |
| 状态     | 布尔     | 是   | 启用/停用 | 停用后不展示       |

**操作逻辑：**

1. 商户可随时新增/编辑/停用服务
2. 停用的服务立即从用户端隐藏
3. 已下单的服务不受影响（历史订单保持原服务）

------

#### **模块2：会员折扣策略配置**

**功能2.1：VIP等级折扣设置**

**功能描述：**
 商户在平台允许的范围内，设置各会员等级的折扣，以及平日/周末/节假日的差异化折扣。

**页面路径：**
 商户后台 > 会员折扣 > 折扣策略

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
会员折扣策略配置
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【VIP等级折扣】
┌─────────────────────────────────────────────────────┐
│ 等级  | 平台限制范围 | 本店折扣 | 平日额外 | 周末 | 节假日 | 操作 │
│ ───────────────────────────────────────────────── │
│ VIP0  | 无          | 无      | -       | -   | -     | -   │
│ VIP1  | 90折-95折   | 95折    | 无      | 无  | 无    | [编辑]│
│ VIP2  | 85折-93折   | 90折    | 再9折   | 无  | 无    | [编辑]│
│ VIP3  | 85折-9折    | 88折    | 再85折  | 无  | 不可用 | [编辑]│
│ VIP4  | 80折-88折   | 85折    | 再8折   | 无  | 不可用 | [编辑]│
│ VIP5  | 75折-85折   | 82折    | 再8折   | 无  | 不可用 | [编辑]│
│ VIP6  | 70折-82折   | 78折    | 再75折  | 无  | 不可用 | [编辑]│
│ VIP7  | 65折-8折    | 75折    | 再75折  | 无  | 不可用 | [编辑]│
│ VIP8  | 60折-75折   | 70折    | 再7折   | 无  | 不可用 | [编辑]│
│ VIP9  | 55折-7折    | 65折    | 再7折   | 无  | 不可用 | [编辑]│
└─────────────────────────────────────────────────────┘

说明：
• 本店折扣：必须在平台限制范围内
• 平日额外：在本店折扣基础上再打折（吸引平日客流）
• 周末：周末是否给予额外折扣
• 节假日：节假日是否允许使用VIP折扣
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**编辑弹窗：**

```
┌─────────────────────────────────┐
│  编辑VIP3折扣策略                    │
│  ─────────────────────────────  │
│  平台限制范围：85折-9折              │
│                                    │
│  本店折扣：                         │
│  [____88____] 折                  │
│  （必须在85折-9折范围内）            │
│                                    │
│  平日额外折扣：                      │
│  ☑ 启用 [____85____] 折           │
│  （在88折基础上再打85折）            │
│                                    │
│  周末折扣：                         │
│  □ 启用 [________] 折             │
│                                    │
│  节假日折扣：                        │
│  □ 允许使用VIP折扣                 │
│  ☑ 节假日不享受VIP折扣              │
│                                    │
│  [取消]  [确定]                     │
└─────────────────────────────────┘
```

**字段说明：**

| 字段名称     | 字段类型 | 必填 | 取值范围   | 说明             |
| ------------ | -------- | ---- | ---------- | ---------------- |
| 本店折扣     | 小数     | 是   | 平台范围内 | 例如88折=0.88    |
| 平日额外折扣 | 小数     | 否   | 0.5-1.0    | 在本店折扣上再折 |
| 周末折扣     | 小数     | 否   | 0.5-1.0    | 周末额外折扣     |
| 节假日可用   | 布尔     | 是   | 是/否      | 节假日是否允许   |

**校验规则：**

1. 本店折扣必须在平台范围内
2. 额外折扣不能低于0.5折
3. 至少选择一项（平日/周末/节假日）可用

**操作逻辑：**

1. 修改后立即生效（对新订单生效）
2. 历史订单价格不受影响
3. 用户查看价格时实时计算

------

#### **模块3：代客下单**

**功能3.1：创建代客下单**

**功能描述：**
 商户为老客户创建专属订单，设定特殊价格和要求，生成付款二维码。

**页面路径：**
 商户后台 > 订单管理 > 代客下单

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
创建代客下单
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【订单信息】
┌─────────────────────────────────┐
│ 房型选择：                          │
│ [豪华大床房 ▼]                     │
│                                    │
│ 入住日期：                          │
│ [2025-12-01]                      │
│                                    │
│ 离店日期：                          │
│ [2025-12-02]                      │
│                                    │
│ 间夜数：1晚（自动计算）              │
└─────────────────────────────────┘

【价格设置】
┌─────────────────────────────────┐
│ 门市价格：¥500                     │
│                                    │
│ 专属特惠价：                        │
│ [____350____] 元                  │
│                                    │
│ 说明：可设置低于门市价的特殊价格      │
└─────────────────────────────────┘

【特殊要求】（选填）
┌─────────────────────────────────┐
│ [√] 含双份早餐                      │
│ [√] 延迟退房至14:00                 │
│ [ ] 免费升级房型                    │
│ [ ] 其他：[__________]             │
└─────────────────────────────────┘

【备注】
┌─────────────────────────────────┐
│ [老客户张总专属订单，已电话沟通确认]   │
└─────────────────────────────────┘

[生成付款码]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**点击"生成付款码"后展示：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
代客下单付款码
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【付款信息】
┌─────────────────────────────────┐
│           [二维码图片]              │
│                                    │
│   XX豪华酒店                        │
│   地址：北京市朝阳区XX路88号         │
│                                    │
│   豪华大床房                        │
│   12月1日-12月2日（1晚）            │
│   含双份早餐、延迟退房至14:00        │
│                                    │
│   专属特惠价：¥350                  │
│                                    │
│   请客户扫码完成支付                 │
│   （此码仅可支付一次，7天内有效）     │
│                                    │
│   订单号：DKD2025120101234          │
└─────────────────────────────────┘

[保存图片] [打印] [发送微信] [关闭]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**操作逻辑：**

1. 填写完整信息后生成付款码
2. 付款码7天内有效，超期自动作废
3. 可保存图片或直接发送给客户
4. 客户扫码后必须登录才能支付
5. 支付成功后订单自动进入"待入住"状态

------

**功能3.2：代客下单订单管理**

**功能描述：**
 查看所有代客下单订单的状态，包括待支付、待入住、已入住、已离店。

**页面路径：**
 商户后台 > 订单管理 > 代客下单列表

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
代客下单订单列表
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【筛选条件】
┌─────────────────────────────────────────┐
│ 订单状态：[全部 ▼]  日期：[最近7天 ▼]     │
│ [搜索]  [重置]                              │
└─────────────────────────────────────────┘

【订单列表】
┌──────────────────────────────────────────────────────────┐
│ 订单号    | 客户  | 房型    | 日期      | 金额 | 状态   | 操作 │
│ ────────────────────────────────────────────────────── │
│ DKD20251201| 张三 | 豪华大床 | 12-01至02| ¥350| 待支付 | [详情]│
│ DKD20251128| 李四 | 豪华双床 | 11-28至29| ¥400| 已支付 | [详情]│
│ DKD20251120| 王五 | 行政套房 | 11-20至21| ¥600| 已入住 | [详情]│
│ DKD20251115| 赵六 | 豪华大床 | 11-15至16| ¥350| 已离店 | [详情]│
└──────────────────────────────────────────────────────────┘

[上一页] 1/5 [下一页]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**点击"详情"查看订单详情：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
代客下单详情
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

订单号：DKD2025120101234
订单状态：已支付，待入住

【客户信息】
姓名：张三
手机：138****1234

【订单信息】
房型：豪华大床房
入住日期：2025-12-01 14:00后
离店日期：2025-12-02 12:00前
间夜数：1晚

【价格信息】
门市价：¥500
专属特惠价：¥350
实付金额：¥350

【特殊要求】
• 含双份早餐
• 延迟退房至14:00

【备注】
老客户张总专属订单，已电话沟通确认

【操作记录】
2025-11-22 10:00  商户创建订单
2025-11-22 10:05  客户扫码支付成功

[办理入住] [返回列表]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

#### **模块4：订单状态管理**

**功能4.1：订单入住/离店操作**

**功能描述：**
 商户办理用户入住和离店操作，更新订单状态。

**页面路径：**
 商户后台 > 订单管理 > 订单列表

**入住操作：**

```
┌─────────────────────────────────┐
│  办理入住                           │
│  ─────────────────────────────  │
│  订单号：20251128001               │
│  客户：张三                         │
│  房型：豪华大床房                    │
│  入住日期：2025-11-28              │
│                                    │
│  实际入住时间：                      │
│  [2025-11-28 14:30]               │
│                                    │
│  房间号：                           │
│  [____3208____]                   │
│                                    │
│  [取消]  [确认入住]                 │
└─────────────────────────────────┘
```

**离店操作：**

```
┌─────────────────────────────────┐
│  办理离店                           │
│  ─────────────────────────────  │
│  订单号：20251128001               │
│  客户：张三                         │
│  房型：豪华大床房                    │
│  房间号：3208                      │
│                                    │
│  实际离店时间：                      │
│  [2025-11-29 12:00]               │
│                                    │
│  备注（选填）：                      │
│  [________________________]       │
│                                    │
│  [取消]  [确认离店]                 │
└─────────────────────────────────┘
```

**操作逻辑：**

1. 入住时必须填写房间号
2. 离店时系统自动触发：
   - 计算间夜数，更新用户累计间夜
   - 检查环保承诺，自动发放奖励积分
   - 检查是否为被邀请用户的首单，发放邀请奖励
   - 检查是否达到升级/保级条件

------

### **【C端】功能PRD**

------

#### **模块1：用户中心**

**功能1.1：积分余额与明细**

**功能描述：**
 用户查看当前积分余额、积分价值、积分获取和使用明细。

**页面路径：**
 小程序 > 我的 > 我的积分

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
我的积分
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【积分余额】
┌─────────────────────────────────┐
│          150                       │
│       当前积分                       │
│                                    │
│   积分价值：1.2倍（VIP3专享）        │
│   可抵扣：¥180                      │
└─────────────────────────────────┘

【获取积分】
┌─────────────────────────────────┐
│  [邀请好友]  每邀请1位好友完成首单   │
│              可获得30积分           │
│                                    │
│  [环保行动]  自带拖鞋/牙刷等        │
│              离店后获得积分          │
└─────────────────────────────────┘

【积分明细】
┌─────────────────────────────────┐
│ 11-22 14:30                        │
│ 环保奖励 - 自带拖鞋                 │
│ +5积分  余额：150                  │
│                                    │
│ 11-22 14:00                        │
│ 抵扣房费 - XX酒店订单               │
│ -50积分  余额：145                 │
│                                    │
│ 11-22 14:00                        │
│ 兑换早餐 - XX酒店订单               │
│ -20积分  余额：195                 │
│                                    │
│ 11-15 16:00                        │
│ 邀请奖励 - 好友张三首次入住          │
│ +30积分  余额：215                 │
│                                    │
│ [查看更多]                          │
└─────────────────────────────────┘
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

**功能1.2：会员等级与权益**

**功能描述：**
 用户查看当前会员等级、升级进度、保级进度、会员权益。

**页面路径：**
 小程序 > 我的 > 会员中心

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
会员中心
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【当前等级】
┌─────────────────────────────────┐
│       [VIP3徽章图标]                │
│       VIP3会员                      │
│                                    │
│   有效期至：2026-10-15              │
│   累计入住：32间夜                  │
└─────────────────────────────────┘

【升级进度】
┌─────────────────────────────────┐
│ 距离VIP4还差28间夜                  │
│ ████████░░░░░░░░░░ 32/60         │
└─────────────────────────────────┘

【保级进度】
┌─────────────────────────────────┐
│ 有效期内已完成12间夜                 │
│ 还需3间夜即可保级                    │
│ ████████████░░░░ 12/15           │
└─────────────────────────────────┘

【会员权益】
┌─────────────────────────────────┐
│ ✓ 88折专享折扣                      │
│ ✓ 积分价值1.2倍                     │
│ ✓ 平日额外折扣                      │
│ ✓ 优先客服                         │
└─────────────────────────────────┘

【等级说明】
[查看完整等级体系]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

**功能1.3：邀请好友**

**功能描述：**
 用户点击邀请好友，选择微信好友发送小程序卡片，自动携带邀请码。

**页面路径：**
 小程序 > 我的 > 邀请好友

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
邀请好友得积分
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【邀请奖励】
┌─────────────────────────────────┐
│     每邀请1位好友                   │
│     完成首次入住                    │
│     即可获得30积分                  │
└─────────────────────────────────┘

【邀请记录】
┌─────────────────────────────────┐
│ 已邀请好友：3人                     │
│ 已获得积分：90                      │
│                                    │
│ • 张三  已入住  +30积分             │
│ • 李四  已入住  +30积分             │
│ • 王五  已注册  待入住              │
└─────────────────────────────────┘

[邀请好友]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**点击"邀请好友"后：**

```
调用微信分享接口 
→ 选择微信好友 
→ 发送小程序卡片

卡片内容：
━━━━━━━━━━━━━━━━━━
[小程序卡片]
好友XXX邀请你入住优惠酒店
新人注册立享30积分
VIP会员尊享折扣
[立即注册]
━━━━━━━━━━━━━━━━━━
（卡片链接自动携带邀请人ID）
```

------

#### **模块2：酒店浏览与预订**

**功能2.1：酒店列表页**

**功能描述：**
 用户浏览酒店列表，查看会员专属价格（已自动计算折扣）。

**页面路径：**
 小程序 > 首页 > 酒店列表

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
酒店列表
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【筛选】
[全部区域 ▼] [价格排序 ▼] [筛选]

【酒店列表】
┌─────────────────────────────────┐
│ [酒店图片]                          │
│ XX豪华酒店                 ★★★★☆  │
│ 朝阳区XX路88号                      │
│                                    │
│ ¥396起/晚  VIP3专享                │
│ 原价¥500  平日特惠                  │
│                                    │
│ [查看详情]                          │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ [酒店图片]                          │
│ YY精品酒店                 ★★★★   │
│ 海淀区YY路66号                      │
│                                    │
│ ¥280起/晚  VIP3专享                │
│ 原价¥350  周末特惠                  │
│                                    │
│ [查看详情]                          │
└─────────────────────────────────┘

[加载更多]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**价格展示规则：**

- 显示该酒店所有房型中折扣后的最低价
- 标注"VIP X专享"显示当前等级
- 显示原价作为对比
- 标注时段（平日/周末/节假日）

------

**功能2.2：酒店详情页**

**功能描述：**
 用户查看酒店详情，查看各房型的会员折扣价。

**页面路径：**
 小程序 > 酒店列表 > 酒店详情

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
XX豪华酒店
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[酒店轮播图]

【酒店信息】
★★★★☆
地址：北京市朝阳区XX路88号
电话：010-12345678

【房型列表】
┌─────────────────────────────────┐
│ [房型图片]                          │
│ 豪华大床房                          │
│ 30㎡ | 大床 | 免费WiFi              │
│                                    │
│ 原价：¥500                         │
│ VIP3折扣：¥440（88折）              │
│ 平日特惠：¥396（再85折）            │
│                                    │
│ [选择]                              │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ [房型图片]                          │
│ 豪华双床房                          │
│ 35㎡ | 双床 | 免费WiFi              │
│                                    │
│ 原价：¥600                         │
│ VIP3折扣：¥528（88折）              │
│ 平日特惠：¥475（再85折）            │
│                                    │
│ [选择]                              │
└─────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

**功能2.3：订单确认页**

**功能描述：**
 用户选择入住日期、积分抵扣、积分服务，查看应付金额。

**页面路径：**
 小程序 > 酒店详情 > 选择房型 > 订单确认

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
订单确认
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【酒店信息】
XX豪华酒店 - 豪华大床房
地址：北京市朝阳区XX路88号

【入住信息】
入住日期：[2025-11-28 ▼]
离店日期：[2025-11-29 ▼]
共1晚

【房费明细】
房费：¥396（VIP3平日特惠价）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【积分服务】（商家提供）

环保奖励（离店后返还）
☐ 自带拖鞋  +5积分
☐ 自带牙刷  +3积分

增值服务（立即扣除）
□ 单人早餐  -20积分
□ 双人早餐  -35积分
□ 延迟退房  -15积分

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【积分抵扣】
当前积分：80
积分价值：1.2倍（1积分=1.2元）
可抵扣最多：¥96

使用积分：[____] 积分
（最多可用80积分）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

【费用明细】
房费：¥396
积分抵扣：-¥0
积分服务：-0积分

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
应付金额：¥396
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[确认支付]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

**交互逻辑：**

1. 用户勾选服务或输入积分，实时计算应付金额
2. 校验：服务消耗+抵扣消费 ≤ 剩余积分
3. 超出限制时弹窗提示："积分不足，请调整"
4. 确认支付前再次校验积分余额

------

**功能2.4：支付成功页**

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
支付成功！
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[成功图标]

订单号：20251128001
XX豪华酒店
豪华大床房

入住日期：11月28日 14:00后
离店日期：11月29日 12:00前

已支付：¥336

[查看订单] [返回首页]
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

#### **模块3：订单管理**

**功能3.1：订单列表**

**页面路径：**
 小程序 > 我的 > 我的订单

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
我的订单
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

[全部] [待入住] [已入住] [已离店]

【订单列表】
┌─────────────────────────────────┐
│ XX豪华酒店                          │
│ 豪华大床房                          │
│ 11月28日-11月29日                   │
│                                    │
│ 订单状态：待入住                    │
│ 实付金额：¥336                     │
│                                    │
│ [查看详情]                          │
└─────────────────────────────────┘

┌─────────────────────────────────┐
│ YY精品酒店                          │
│ 豪华双床房                          │
│ 11月20日-11月21日                   │
│                                    │
│ 订单状态：已离店                    │
│ 实付金额：¥280                     │
│ 获得积分：+5（环保奖励）             │
│                                    │
│ [查看详情] [再次预订]                │
└─────────────────────────────────┘

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

**功能3.2：订单详情**

**页面布局：**

```
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
订单详情
━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━

订单号：20251128001
订单状态：待入住

【酒店信息】
XX豪华酒店
地址：北京市朝阳区XX路88号
电话：010-12345678

【入住信息】
房型：豪华大床房
入住：2025-11-28 14:00后
离店：2025-11-29 12:00前

【费用明细】
房费：¥396（VIP3平日特惠）
积分抵扣：-¥60（50积分×1.2）
积分服务：-20积分（单人早餐）
应付金额：¥336

【积分记录】
• 使用50积分抵扣房费（¥60）
• 兑换单人早餐（-20积分）
• 承诺自带拖鞋（离店后+5积分）

━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━
```

------

## 三、关键设计总结

### **数据流向**

1. **用户维度**：注册 → 获得积分 → 预订消费 → 累计间夜 → 升级/保级
2. **订单维度**：浏览 → 折扣计算 → 下单 → 支付 → 入住 → 离店 → 积分结算

### **三端职责**

- **平台后台**：制定规则（积分汇率、会员等级、折扣范围）
- **商户端**：执行配置（积分服务、差异化折扣、代客下单）
- **C端**：体验使用（查看权益、预订支付、消费积分）

### **核心逻辑**

1. **价格展示时机**：列表页和详情页就已经计算好折扣价
2. **积分时序**：下单时预扣除消耗积分，离店后发放奖励积分
3. **会员升降级**：基于间夜数自动升级，基于有效期和保级间夜自动降级
4. **代客下单**：不支持积分功能，二维码仅可支付一次