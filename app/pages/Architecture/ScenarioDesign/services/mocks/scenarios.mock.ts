/**
 * 场景设计 Mock 数据
 */

import type { Scenario } from '../../types/scenario.types'
import { ScenarioType } from '../../types/scenario.types'

export const mockScenarios: Scenario[] = [
  {
    id: 'scenario-1',
    type: ScenarioType.USER_REGISTRATION,
    title: '流程1：用户注册 → 获得积分',
    description: '新用户注册后自动获得30积分，初始化为VIP0等级',
    flowSteps: [
      {
        id: 'step-1-1',
        title: 'C端用户注册',
        description: '用户在小程序填写注册信息',
        system: 'C端',
        details: [
          '填写手机号、密码',
          '提交注册信息',
        ],
      },
      {
        id: 'step-1-2',
        title: '平台后台自动触发',
        description: '系统自动创建用户账户并初始化数据',
        system: '平台后台',
        details: [
          '创建用户账户',
          '初始化VIP0等级（间夜数=0）',
          '自动发放30积分',
          '记录注册时间',
        ],
      },
      {
        id: 'step-1-3',
        title: 'C端注册成功页',
        description: '向用户展示注册成功信息',
        system: 'C端',
        details: [
          '显示：欢迎XXX，已获得30积分',
          '显示：当前VIP0等级',
        ],
      },
    ],
    keyPoints: [
      '新用户注册自动获得30积分',
      '初始等级为VIP0',
      '间夜数初始化为0',
    ],
  },
  {
    id: 'scenario-2',
    type: ScenarioType.MEMBER_LEVEL,
    title: '流程2：会员等级升降机制',
    description: '基于累计间夜数的会员等级升级和保级机制',
    flowSteps: [
      {
        id: 'step-2-1',
        title: '平台后台设定升级规则',
        description: '配置各等级的升级条件',
        system: '平台后台',
        details: [
          'VIP0 → VIP1：累计5间夜，有效期365天',
          'VIP1 → VIP2：累计15间夜，有效期365天',
          'VIP2 → VIP3：累计30间夜，有效期365天',
          'VIP3 → VIP4：累计60间夜，有效期365天',
        ],
      },
      {
        id: 'step-2-2',
        title: '订单维度计算间夜数',
        description: '用户完成订单后自动计算间夜',
        system: '平台后台',
        details: [
          '订单状态变更为"已离店"时触发',
          '间夜数 = 离店日期 - 入住日期',
          '累计间夜数 = 原累计 + 本次间夜',
        ],
      },
      {
        id: 'step-2-3',
        title: '检查升级条件',
        description: '判断是否达到升级标准',
        system: '平台后台',
        details: [
          '检查累计间夜是否达标',
          '达标则升级会员等级',
          '设置会员有效期（如365天后到期）',
          '重置保级间夜计数器=0',
        ],
      },
      {
        id: 'step-2-4',
        title: 'C端收到升级通知',
        description: '向用户推送升级消息',
        system: 'C端',
        details: [
          '恭喜升级至VIP3！',
          '享受88折优惠，积分价值提升至1.2倍',
          '有效期至2026年11月22日',
          '期间完成20间夜可保级',
        ],
      },
      {
        id: 'step-2-5',
        title: '平台后台设定保级规则',
        description: '配置各等级的保级条件',
        system: '平台后台',
        details: [
          'VIP1保级：有效期内完成3间夜',
          'VIP2保级：有效期内完成8间夜',
          'VIP3保级：有效期内完成15间夜',
          'VIP4保级：有效期内完成25间夜',
        ],
      },
      {
        id: 'step-2-6',
        title: '定时任务检查保级',
        description: '每日凌晨扫描会员有效期',
        system: '平台后台',
        details: [
          '扫描所有用户会员有效期',
          '检查有效期内的保级间夜数',
          '未达标则降级至上一等级',
          '重新设置有效期和保级计数器',
        ],
      },
      {
        id: 'step-2-7',
        title: 'C端收到降级通知',
        description: '向用户推送降级消息',
        system: 'C端',
        details: [
          '您的VIP3会员已到期',
          '因有效期内未完成15间夜',
          '已降级至VIP2',
          '继续努力，完成8间夜即可保持VIP2等级',
        ],
      },
    ],
    keyPoints: [
      '升级条件：累计总间夜数',
      '保级条件：有效期内间夜数',
      '会员有效期：升级后开始计算',
      '定时任务：每日凌晨自动检查',
      '数据记录：当前等级、累计间夜、保级间夜、有效期',
    ],
  },
  {
    id: 'scenario-3',
    type: ScenarioType.INVITE_FRIEND,
    title: '流程3：邀请好友 → 获得奖励积分',
    description: '用户邀请好友注册并完成首次入住后获得30积分奖励',
    flowSteps: [
      {
        id: 'step-3-1',
        title: 'C端用户点击邀请好友',
        description: '用户发起邀请操作',
        system: 'C端',
        details: [
          '点击"邀请好友"按钮',
          '调用微信分享接口',
          '选择微信好友',
        ],
      },
      {
        id: 'step-3-2',
        title: '发送小程序卡片',
        description: '分享邀请链接给好友',
        system: 'C端',
        details: [
          '卡片标题：好友XXX邀请你入住优惠酒店',
          '卡片内容：新人注册立享30积分',
          '卡片链接自动携带：inviter_id=用户A的ID',
        ],
      },
      {
        id: 'step-3-3',
        title: '被邀请用户打开小程序',
        description: '好友点击卡片注册',
        system: 'C端',
        details: [
          '用户B点击卡片',
          '打开小程序注册页',
          '注册表单自动填充邀请码（后台处理）',
        ],
      },
      {
        id: 'step-3-4',
        title: '平台后台记录邀请关系',
        description: '系统记录推荐人信息',
        system: '平台后台',
        details: [
          '创建用户B账户',
          '记录邀请关系：B的推荐人=A',
          '发放注册积分30分',
        ],
      },
      {
        id: 'step-3-5',
        title: '被邀请用户完成首单',
        description: '用户B完成首次预订并离店',
        system: '平台后台',
        details: [
          '监听订单状态变更为"已离店"',
          '检查该订单用户是否有推荐人',
          '检查是否为首单',
        ],
      },
      {
        id: 'step-3-6',
        title: '自动发放邀请奖励',
        description: '给推荐人发放积分',
        system: '平台后台',
        details: [
          '确认是被邀请用户的首单',
          '给推荐人A发放30积分',
          '记录奖励来源',
        ],
      },
      {
        id: 'step-3-7',
        title: 'C端邀请人收到通知',
        description: '向邀请人推送奖励消息',
        system: 'C端',
        details: [
          '您的好友张三完成首次入住',
          '获得30积分奖励！',
        ],
      },
    ],
    keyPoints: [
      '邀请链接自动携带邀请人ID',
      '仅首次离店后发放奖励',
      '奖励金额：30积分',
      '支持无限层级邀请',
    ],
  },
  {
    id: 'scenario-4',
    type: ScenarioType.BROWSE_HOTEL,
    title: '流程4：浏览酒店 → 查看会员专属价格',
    description: '用户浏览酒店时，系统根据会员等级和商户配置自动计算折扣价格',
    flowSteps: [
      {
        id: 'step-4-1',
        title: 'C端用户打开小程序',
        description: '读取用户会员信息',
        system: 'C端',
        details: [
          '获取用户ID',
          '获取会员等级（如VIP3）',
          '获取积分余额',
        ],
      },
      {
        id: 'step-4-2',
        title: '平台后台价格计算',
        description: '为每个酒店计算会员价',
        system: '平台后台',
        details: [
          '步骤1：判断当日是否可用VIP折扣',
          '读取商户端设置：平日/周末/节假日折扣开关',
          '当前日期：2025-11-28（节假日）→ 不可用VIP折扣',
          '步骤2：计算VIP折扣价格（如可用）',
          '用户等级：VIP3',
          '平台折扣范围：85折-9折',
          '商户VIP3折扣：88折（在范围内）',
          '商户时段额外折扣：平日再打9折',
          '最终价格：¥500 × 0.88 × 0.9 = ¥396',
        ],
      },
      {
        id: 'step-4-3',
        title: 'C端酒店列表页展示',
        description: '显示计算后的会员价',
        system: 'C端',
        details: [
          'XX豪华酒店',
          '¥396起/晚 VIP3专享',
          '原价¥500 平日特惠',
        ],
      },
      {
        id: 'step-4-4',
        title: 'C端酒店详情页展示',
        description: '展示各房型的折扣价格',
        system: 'C端',
        details: [
          '豪华大床房：原价¥500 → VIP3折扣¥440（88折）→ 平日特惠¥396（再9折）',
          '豪华双床房：原价¥600 → VIP3折扣¥528（88折）→ 平日特惠¥475（再9折）',
          '行政套房：原价¥800 → VIP3折扣¥704（88折）→ 平日特惠¥634（再9折）',
        ],
      },
    ],
    keyPoints: [
      '价格计算优先级：时段可用性 → VIP折扣 → 时段额外折扣',
      '商户折扣必须在平台范围内',
      '列表页显示最低价',
      '详情页显示所有房型价格',
      '实时计算，不缓存',
    ],
  },
  {
    id: 'scenario-5',
    type: ScenarioType.ORDER_PAYMENT,
    title: '流程5：下单 → 积分换购/抵扣 → 支付',
    description: '用户下单时可选择积分换购服务和积分抵扣，系统实时校验积分余额',
    flowSteps: [
      {
        id: 'step-5-1',
        title: 'C端用户选择房型',
        description: '进入订单确认页',
        system: 'C端',
        details: [
          '选择入住/离店日期',
          '确认房型和价格',
          '进入订单确认页',
        ],
      },
      {
        id: 'step-5-2',
        title: '平台后台读取配置',
        description: '获取用户积分和增值服务配置',
        system: '平台后台',
        details: [
          '读取用户剩余积分：80积分',
          '读取平台积分换购服务配置（单人早餐、双人早餐、延迟退房等）',
          '读取用户会员等级积分倍数：1.2倍（VIP3）',
        ],
      },
      {
        id: 'step-5-3',
        title: 'C端订单确认页展示',
        description: '显示积分换购服务选项',
        system: 'C端',
        details: [
          '房费：¥396（VIP3平日特惠价）',
          '积分换购服务（立即扣除积分）：',
          '  □ 单人早餐 -20积分',
          '  □ 双人早餐 -35积分',
          '  □ 延迟退房至14:00 -15积分',
          '  □ 房型升级 -50积分',
          '积分抵扣：当前积分80，可抵扣最多66积分（80×1.2=¥96，但房费只需¥396，最多抵扣¥79.2≈66积分）',
        ],
      },
      {
        id: 'step-5-4',
        title: '用户选择服务和抵扣',
        description: '勾选服务并输入抵扣积分',
        system: 'C端',
        details: [
          '勾选"单人早餐"（需消耗20积分）',
          '勾选"延迟退房至14:00"（需消耗15积分）',
          '输入"40"积分抵扣房费',
        ],
      },
      {
        id: 'step-5-5',
        title: '平台后台实时校验',
        description: '验证积分余额是否足够',
        system: '平台后台',
        details: [
          '换购服务消耗积分：20 + 15 = 35积分',
          '抵扣消费积分：40积分',
          '总需积分：75积分',
          '当前积分：80积分',
          '结论：通过（75 ≤ 80）',
          '价格计算：',
          '  房费：¥396',
          '  积分抵扣：40 × 1.2 = ¥48',
          '  应付：¥396 - ¥48 = ¥348',
        ],
      },
      {
        id: 'step-5-6',
        title: 'C端动态显示应付金额',
        description: '实时更新费用明细',
        system: 'C端',
        details: [
          '积分使用明细：',
          '  换购单人早餐：-20积分',
          '  换购延迟退房：-15积分',
          '  抵扣房费：-40积分（¥48）',
          '应付金额：¥348',
          '剩余积分：5积分',
        ],
      },
      {
        id: 'step-5-7',
        title: '用户确认支付',
        description: '提交订单并支付',
        system: 'C端',
        details: [
          '点击"确认支付"',
          '调用微信支付',
          '支付金额：¥348',
        ],
      },
      {
        id: 'step-5-8',
        title: '平台后台预扣积分',
        description: '扣除已使用的积分',
        system: '平台后台',
        details: [
          '剩余积分：80 - 35 - 40 = 5积分',
          '创建订单，状态="待入住"',
          '记录换购服务：单人早餐、延迟退房',
          '记录积分使用明细',
        ],
      },
      {
        id: 'step-5-9',
        title: 'C端支付成功页',
        description: '显示订单信息',
        system: 'C端',
        details: [
          '支付成功！',
          '订单号：20251128001',
          'XX豪华酒店 豪华大床房',
          '入住：11月28日 14:00后',
          '离店：11月29日 14:00前（已延迟至14:00）',
          '已含单人早餐',
        ],
      },
    ],
    keyPoints: [
      '积分换购服务：平台统一配置，商户不可修改',
      '最大可用积分 = min(剩余积分, 房费/积分倍数)',
      '实时校验：换购消耗+抵扣消费 ≤ 剩余积分',
      '换购服务立即扣除积分，订单中记录服务内容',
      '支付前预扣除所有积分',
    ],
  },
  {
    id: 'scenario-6',
    type: ScenarioType.CHECKOUT_REWARD,
    title: '流程6：离店 → 积分奖励 → 会员升级 → 邀请奖励',
    description: '用户离店后，系统自动计算间夜数、发放积分奖励、检查会员升级和邀请奖励',
    flowSteps: [
      {
        id: 'step-6-1',
        title: '商户端办理退房',
        description: '商户办理离店手续',
        system: '商户端',
        details: [
          '查看订单详情',
          '确认服务已完成',
          '点击"办理退房"',
          '订单状态改为"已离店"',
          '填写实际离店时间',
        ],
      },
      {
        id: 'step-6-2',
        title: '平台后台监听状态变更',
        description: '触发自动结算流程',
        system: '平台后台',
        details: [
          '监听订单状态变更事件',
          '检测到"已离店"状态',
          '触发自动结算流程',
        ],
      },
      {
        id: 'step-6-3',
        title: '计算间夜数',
        description: '更新用户间夜统计',
        system: '平台后台',
        details: [
          '入住日期：2025-11-28',
          '离店日期：2025-11-29',
          '间夜数：1',
          '累计总间夜数：29 → 30',
          '保级间夜计数器：14 → 15',
        ],
      },
      {
        id: 'step-6-4',
        title: '检查会员升级条件',
        description: '判断是否达到升级标准',
        system: '平台后台',
        details: [
          '当前等级：VIP2',
          '升级条件：累计30间夜',
          '结论：达成升级条件',
          '操作：升级至VIP3',
          '设置有效期：2026-11-28（365天后）',
          '重置保级计数器=0',
          '读取VIP3赠送规则：',
          '  赠送体验次数：2次',
          '  赠送有效期：30天',
          '创建体验卡：2次免费住宿，30天内有效',
        ],
      },
      {
        id: 'step-6-5',
        title: '发放积分奖励服务',
        description: '根据平台配置的积分奖励服务发放积分',
        system: '平台后台',
        details: [
          '读取平台积分奖励服务配置',
          '检查订单中的奖励服务选择（如有）',
          '示例：用户选择了"自带拖鞋"、"自带牙刷"',
          '发放：自带拖鞋 +5积分',
          '发放：自带牙刷 +3积分',
          '记录积分来源：积分奖励服务',
        ],
      },
      {
        id: 'step-6-6',
        title: '检查邀请奖励',
        description: '判断是否发放邀请奖励',
        system: '平台后台',
        details: [
          '该用户是否被推荐：是（推荐人=用户A）',
          '是否首单：是',
          '发放：给推荐人A +30积分',
          '记录积分来源：邀请好友奖励',
        ],
      },
      {
        id: 'step-6-7',
        title: 'C端用户收到通知',
        description: '向用户推送离店和升级消息',
        system: 'C端',
        details: [
          '感谢入住！',
          '积分奖励：',
          '  自带拖鞋 +5积分',
          '  自带牙刷 +3积分',
          '恭喜升级至VIP3！',
          '升级福利：',
          '  会员有效期至2026年11月28日',
          '  赠送2次免费住宿体验（30天内有效）',
          '  享受88折优惠，积分倍数1.2倍',
          '查看我的会员卡 >',
        ],
      },
      {
        id: 'step-6-8',
        title: 'C端推荐人收到通知',
        description: '向邀请人推送奖励消息',
        system: 'C端',
        details: [
          '您的好友张三完成首次入住',
          '获得30积分奖励！',
          '继续邀请好友，赚取更多积分 >',
        ],
      },
    ],
    keyPoints: [
      '离店触发自动结算',
      '间夜数实时累计',
      '自动检查升级并发放体验次数',
      '积分奖励服务：平台配置，离店后发放',
      '会员升级赠送：体验次数+有效期（可配置）',
      '邀请奖励仅首单发放',
    ],
  },
  {
    id: 'scenario-7',
    type: ScenarioType.AGENT_ORDER,
    title: '流程7：老客服务 - 创建专属订单（限制购买人）',
    description: '商户为老客户创建专属订单，生成付款二维码，限制仅指定手机号可支付',
    flowSteps: [
      {
        id: 'step-7-1',
        title: '商户端点击"老客服务"',
        description: '进入老客服务页面',
        system: '商户端',
        details: [
          '进入"老客服务"菜单',
          '选择"创建专属订单"',
        ],
      },
      {
        id: 'step-7-2',
        title: '商户端填写订单信息',
        description: '填写订单详情和限制条件',
        system: '商户端',
        details: [
          '房型：豪华大床房',
          '入住日期：2025-12-01',
          '离店日期：2025-12-02',
          '专属特惠价：¥350',
          '特殊服务：含双份早餐、延迟退房至14:00',
          '限制购买人手机号：138****1234（可选）',
          '订单有效期：7天（默认）',
        ],
      },
      {
        id: 'step-7-3',
        title: '点击生成付款码',
        description: '创建待支付专属订单',
        system: '商户端',
        details: [
          '提交订单信息',
          '等待系统生成付款码',
        ],
      },
      {
        id: 'step-7-4',
        title: '平台后台创建专属订单',
        description: '生成待支付订单和二维码',
        system: '平台后台',
        details: [
          '订单号：DKD2025120101234',
          '订单来源：老客专属订单',
          '订单状态：待支付',
          '支付次数限制：1次',
          '限制购买人手机号：138****1234',
          '有效期：7天',
          '禁用积分功能标识：true',
          '生成付款二维码（小程序码）',
        ],
      },
      {
        id: 'step-7-5',
        title: '商户端显示付款信息',
        description: '展示二维码和订单详情',
        system: '商户端',
        details: [
          '显示二维码图片',
          'XX豪华酒店',
          '地址：北京市朝阳区XX路88号',
          '豪华大床房 12月1日-12月2日（1晚）',
          '含双份早餐、延迟退房至14:00',
          '专属特惠价：¥350',
          '限制购买人：138****1234',
          '请客户扫码完成支付',
          '（此码仅限指定手机号支付，7天内有效）',
          '订单号：DKD2025120101234',
        ],
      },
      {
        id: 'step-7-6',
        title: '商户展示二维码给客户',
        description: '客户扫码打开小程序',
        system: '商户端',
        details: [
          '商户截图/展示二维码',
          '客户使用微信扫码',
        ],
      },
      {
        id: 'step-7-7',
        title: 'C端客户扫码',
        description: '打开小程序订单页',
        system: 'C端',
        details: [
          '扫码打开小程序',
          '系统读取订单信息',
          '检查登录态',
        ],
      },
      {
        id: 'step-7-8',
        title: '平台后台校验订单和身份',
        description: '验证订单有效性和购买人身份',
        system: '平台后台',
        details: [
          '订单是否存在？是',
          '订单是否过期？否',
          '订单是否已支付？否',
          '用户是否登录？是',
          '获取当前用户手机号：138****1234',
          '检查是否与限制购买人手机号匹配？是',
          '校验通过 → 允许查看订单',
        ],
      },
      {
        id: 'step-7-9',
        title: 'C端展示订单详情',
        description: '显示专属订单信息（不含积分功能）',
        system: 'C端',
        details: [
          'XX豪华酒店',
          '地址：北京市朝阳区XX路88号',
          '电话：010-12345678',
          '老客专属订单',
          '房型：豪华大床房',
          '入住：2025年12月1日 14:00后',
          '离店：2025年12月2日 14:00前',
          '特殊服务：含双份早餐、延迟退房至14:00',
          '专属特惠价：¥350',
          '[确认支付]',
        ],
      },
      {
        id: 'step-7-10',
        title: '客户点击确认支付',
        description: '发起支付流程',
        system: 'C端',
        details: [
          '点击"确认支付"按钮',
          '调用微信支付',
        ],
      },
      {
        id: 'step-7-11',
        title: '平台后台再次校验',
        description: '最终校验订单状态和身份',
        system: '平台后台',
        details: [
          '订单未被支付？是',
          '用户登录态有效？是',
          '用户手机号与限制购买人匹配？是',
          '发起支付流程',
        ],
      },
      {
        id: 'step-7-12',
        title: 'C端调用微信支付',
        description: '完成支付',
        system: 'C端',
        details: [
          '调用微信支付接口',
          '支付金额：¥350',
          '支付成功',
        ],
      },
      {
        id: 'step-7-13',
        title: '平台后台处理支付结果',
        description: '更新订单状态',
        system: '平台后台',
        details: [
          '订单关联用户ID',
          '订单状态="待入住"',
          '支付状态="已支付"',
          '锁定订单（二维码失效）',
        ],
      },
      {
        id: 'step-7-14',
        title: 'C端支付成功页',
        description: '显示支付结果',
        system: 'C端',
        details: [
          '支付成功！',
          'XX豪华酒店 豪华大床房',
          '入住：12月1日 14:00后',
          '离店：12月2日 14:00前（已延迟至14:00）',
          '已含双份早餐',
          '订单号：DKD2025120101234',
          '[查看订单详情] [返回订单列表]',
        ],
      },
      {
        id: 'step-7-15',
        title: '商户端收到订单通知',
        description: '通知商户订单已支付',
        system: '商户端',
        details: [
          '老客专属订单已支付',
          '客户：张三（138****1234）',
          '房型：豪华大床房',
          '入住：12月1日',
        ],
      },
    ],
    keyPoints: [
      '老客服务：商户端功能，服务老客户',
      '限制购买人手机号：可选，指定后仅该手机号可支付',
      '不支持积分抵扣和积分服务',
      '二维码仅可支付一次',
      '支付必须登录，验证手机号身份',
      '订单有效期7天，超期自动作废',
      '商户可设置任意价格（低于门市价）',
    ],
  },
]
